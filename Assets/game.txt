// ==UserScript==
// @name         Starve.io Ad Blocker (Safe Mode)
// @namespace    http://tampermonkey.net/
// @version      1.2
// @description  Safely removes Google Ads and WebGames.io ads from Starve.io when pressing X
// @author       You
// @match        *://starve.io/*
// @grant        none
// ==/UserScript==

(function () {
    'use strict';

    // Add key listener for "X" to trigger ad removal
    document.addEventListener("keydown", (event) => {
        if (event.key.toLowerCase() === "x") {
            // Remove ads
            safelyRemoveAds();

            // Display confirmation text
            const textElement = document.createElement("div");
            textElement.innerText = "Ads Removed!";
            textElement.style.position = "fixed";
            textElement.style.top = "50%";
            textElement.style.left = "50%";
            textElement.style.transform = "translate(-50%, -50%)";
            textElement.style.color = "white";
            textElement.style.backgroundColor = "rgba(0, 0, 0, 0.7)";
            textElement.style.padding = "20px";
            textElement.style.borderRadius = "10px";
            textElement.style.zIndex = "10000";
            textElement.style.fontSize = "24px";
            textElement.style.fontFamily = "Arial, sans-serif";

            document.body.appendChild(textElement);

            // Remove the message after 2 seconds
            setTimeout(() => {
                textElement.remove();
            }, 2000);
        }
    });

    function safelyRemoveAds() {
        console.log("Safely scanning and removing ads...");

        // Collect ads but avoid game-critical elements
        const ads = [
            ...document.querySelectorAll('iframe[src*="google"], div[id*="google"]'),
            ...document.querySelectorAll('iframe[src*="webgames.io"], div[src*="webgames.io"]'),
            ...document.querySelectorAll('[class*="ad"], [id*="ad"]'),
        ];

        ads.forEach((ad) => {
            // Only remove elements that are clearly ads and not critical game elements
            if (ad.offsetParent !== null && !isGameCritical(ad)) {
                ad.remove();
                console.log("Removed an ad:", ad);
            }
        });

        console.log("Safe ad removal completed!");
    }

    function isGameCritical(element) {
        // List of IDs or classes that are game-critical (example placeholders)
        const gameCriticalIds = ["gameCanvas", "mainMenu", "footer", "header"];
        const gameCriticalClasses = ["main-container", "game-container"];

        const idCheck = element.id && gameCriticalIds.includes(element.id);
        const classCheck =
            element.classList &&
            [...element.classList].some((cls) => gameCriticalClasses.includes(cls));

        return idCheck || classCheck;
    }
})();
